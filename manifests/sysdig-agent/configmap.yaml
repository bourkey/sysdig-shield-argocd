apiVersion: v1
kind: ConfigMap
metadata:
  name: sysdig-agent
  namespace: sysdig-shield
  annotations:
    argocd.argoproj.io/sync-wave: "2"
  labels:
    app.kubernetes.io/name: sysdig-agent
    app.kubernetes.io/component: agent
    app.kubernetes.io/part-of: sysdig-shield
data:
  dragent.yaml: |
    # Sysdig Agent Configuration

    # Collector settings
    collector: collector.sysdigcloud.com
    collector_port: 6443
    ssl: true

    # Logging
    log:
      console_priority: info
      file_priority: info

    # Agent tags and labels
    tags:
      - env:production
      - component:sysdig-agent
      - managed-by:argocd

    # Security settings
    security:
      enabled: true
      k8s_audit_server_enabled: true
      k8s_audit_server_port: 7765

    # Kubernetes metadata
    k8s_cluster_name: "default"

    # Prometheus metrics
    prometheus:
      enabled: true
      interval: 30
      log_errors: true
      max_metrics: 3000
      max_metrics_per_process: 400

    # Feature flags
    feature:
      mode: secure

    # Resource limits
    cointerface_enabled: false
    drift_killer:
      enabled: false
