apiVersion: v1
kind: ConfigMap
metadata:
  name: sysdig-kspm-collector
  namespace: sysdig-shield
  annotations:
    argocd.argoproj.io/sync-wave: "2"
  labels:
    app.kubernetes.io/name: sysdig-kspm-collector
    app.kubernetes.io/component: kspm-collector
    app.kubernetes.io/part-of: sysdig-shield
data:
  config.yaml: |
    # KSPM Collector Configuration

    # Sysdig backend
    api_endpoint: https://secure.sysdig.com

    # Compliance benchmarks
    benchmarks:
      enabled: true
      cis_kubernetes: true
      nsa_cisa: true
      pci_dss: true
      soc2: true
      schedule: "0 */6 * * *"  # Every 6 hours

    # RBAC analysis
    rbac_analysis:
      enabled: true
      detect_overpermissive_roles: true
      detect_privilege_escalation: true

    # Network policy evaluation
    network_policy_evaluation:
      enabled: true
      detect_missing_policies: true
      detect_permissive_egress: true

    # Resource quota checking
    resource_quota_checking:
      enabled: true

    # Pod security standards
    pod_security_standards:
      enabled: true

    # Logging
    log_level: info
