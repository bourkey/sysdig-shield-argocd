apiVersion: v1
kind: ConfigMap
metadata:
  name: sysdig-node-analyzer
  namespace: sysdig-shield
  annotations:
    argocd.argoproj.io/sync-wave: "2"
  labels:
    app.kubernetes.io/name: sysdig-node-analyzer
    app.kubernetes.io/component: node-analyzer
    app.kubernetes.io/part-of: sysdig-shield
data:
  analyzer.yaml: |
    # Node Analyzer Configuration

    # API endpoint
    api_endpoint: https://secure.sysdig.com

    # Image analyzer settings
    image_analyzer:
      enabled: true
      scan_on_start: true
      cache_max_size_mb: 1024

    # Host analyzer settings
    host_analyzer:
      enabled: true
      benchmark_runner:
        enabled: true
        schedule: "0 4 * * *"  # Daily at 4 AM
        benchmarks:
        - cis-docker
        - cis-k8s

    # Runtime scanner settings
    runtime_scanner:
      enabled: true
      eve_enabled: true

    # Logging
    log_level: info

    # SSL/TLS
    ssl_verify_certificate: true
