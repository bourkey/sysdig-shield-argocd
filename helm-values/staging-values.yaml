# Staging environment Helm values for sysdig/shield chart
# Extends base-values.yaml with staging-specific overrides

cluster_config:
  name: "staging-cluster"
  tags:
    environment: staging

features:
  # Test admission control in enforce mode
  admission_control:
    enabled: true
    failure_policy: Ignore
    dry_run: false

  posture:
    cluster_posture:
      enabled: true
    host_posture:
      enabled: true

  vulnerability_management:
    container_vulnerability_management:
      enabled: true
    host_vulnerability_management:
      enabled: true
    in_use:
      enabled: true

  detections:
    drift_control:
      enabled: true  # Test runtime threat detection
    malware_control:
      enabled: true  # Test malware detection
    kubernetes_audit:
      enabled: true

  investigations:
    activity_audit:
      enabled: true  # Test forensics capabilities
    live_logs:
      enabled: true  # Test log streaming
    network_security:
      enabled: true  # Test network monitoring
    captures:
      enabled: true  # Test packet capture

  respond:
    rapid_response:
      enabled: true  # Test rapid response
    response_actions:
      enabled: true  # Test automated responses
