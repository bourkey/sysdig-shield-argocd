# Base Helm values for Sysdig Shield deployment
# Chart: sysdig/shield
# Version: 1.28.0 (latest)

cluster_config:
  name: "kubernetes-cluster"

sysdig_endpoint:
  region: us1
  access_key_existing_secret: sysdig-agent
  # access_key: "" # Use existing secret instead

features:
  # Admission Control (Admission Controller)
  admission_control:
    enabled: true
    failure_policy: Ignore  # Change to Fail after validation in production
    dry_run: false
    timeout: 10
    http_port: 8443
    excluded_namespaces:
      - kube-system
      - kube-public
      - kube-node-lease
      - sysdig-shield
    container_vulnerability_management:
      enabled: true
    posture:
      enabled: true

  # Kubernetes Metadata
  kubernetes_metadata:
    enabled: true

  # Posture (KSPM)
  posture:
    cluster_posture:
      enabled: true
    host_posture:
      enabled: true

  # Vulnerability Management (Node Analyzer)
  vulnerability_management:
    container_vulnerability_management:
      enabled: true
    host_vulnerability_management:
      enabled: true
    in_use:
      enabled: true
      integration_enabled: true

  # Detections
  detections:
    drift_control:
      enabled: true
    malware_control:
      enabled: true
    ml_policies:
      enabled: false
    kubernetes_audit:
      enabled: true
      timeout: 10
      http_port: 6443
      excluded_namespaces:
        - kube-system
        - kube-public

  # Investigations
  investigations:
    activity_audit:
      enabled: true
    live_logs:
      enabled: true
    network_security:
      enabled: true
    captures:
      enabled: true

  # Respond
  respond:
    rapid_response:
      enabled: false
    response_actions:
      enabled: true
